# Development Guide ‚ö°

> **SPEED-FIRST DEVELOPMENT** | Focus: Immediate Action | Time-Boxed Workflows | Anti-Paralysis Measures

## ‚ö° Quick Start (< 5 minutes)

### ‚ö° **AI Setup**: Just say `reload_context.md` for instant context loading

### ‚ö° **Environment Setup** (Manual if needed)
```bash
# IMMEDIATE SETUP - NO ANALYSIS
git clone <your-repo>
cd flask-copilot-starter
pipenv install --dev
pipenv shell
```

## ‚ö° Testing Guidelines (Speed-First)

### üß™ **CRITICAL**: Check `docs/copilot/TEST_CHEATSHEET.md` before generating ANY tests
**Prevents AI "guessing" - ensures tests use actual codebase structure**

### ‚ö° Speed-First Test Execution Patterns
**MANDATORY: Use grep to filter pytest output for efficiency**

#### Immediate Test Health Check (< 30 seconds)
```bash
# Quick pass/fail status - avoid processing full output
pytest --tb=no | grep -E "(PASSED|FAILED|ERROR)" | tail -5

# Emergency health check - binary result
pytest | grep -q "FAILED" && echo "‚ùå TESTS FAILING" || echo "‚úÖ ALL TESTS PASS"
```

#### Fast Failure Analysis (< 2 minutes)
```bash
# Get only failure details
pytest -x --tb=short | grep -A 10 -B 2 "FAILED\|ERROR"

# Filter specific error types
pytest | grep -E "(AssertionError|TypeError|ValueError)" -A 3

# Database test issues only
pytest | grep -i -C 3 "database\|sql\|migration"
```

#### Coverage Analysis (< 1 minute)
```bash
# Coverage percentage only - no full report
pytest --cov=app | grep -E "TOTAL.*[0-9]+%"

# Missing coverage lines only
pytest --cov=app --cov-report=term-missing | grep -E "Missing"
```

### Test DatabaseTUP - NO ANALYSIS
git clone <repository-url> && cd flask-copilot-starter
pipenv install && pipenv shell
cp .env.example .env
pipenv run flask db init && pipenv run flask db migrate -m "Initial" && pipenv run flask db upgrade
pipenv run flask run  # READY TO CODE
```

## Project Types
This starter supports development of both Flask applications and Flask extensions:
- **Flask Applications**: Complete web applications with routes, templates, and databases  
- **Flask Extensions**: Reusable packages that extend Flask functionality for other applications

## ‚ö° Anti-Paralysis Development Workflow

### SPEED-FIRST DECISION HIERARCHY (< 2 minutes per decision)
1. **SIMPLEST SOLUTION** (80% default choice) - Use existing patterns
2. **STANDARD PATTERN** (15% of cases) - Follow Flask conventions  
3. **CUSTOM APPROACH** (5% only) - When 1-2 insufficient

### NO-ANALYSIS ZONES ‚ö°
**Auto-Proceed Rules** - These operations require ZERO analysis:
- CRUD operations ‚Üí Use existing model patterns
- Route creation ‚Üí Follow blueprint structure
- Database changes ‚Üí Execute Flask-Migrate workflow
- Form validation ‚Üí Use WTForms patterns
- Authentication ‚Üí Use Flask-Login patterns

### EMERGENCY DECISION PROTOCOL
**If stuck > 2 minutes on ANY decision:**
1. ‚è∞ STOP analysis immediately
2. üéØ Choose simplest approach that could work
3. üöÄ Implement and iterate
4. üìñ Refer to `docs/copilot/DECISION_FRAMEWORK.md`

## Prerequisites
- Python 3.8 or higher
- Pipenv for dependency management
- Git for version control

## Initial Setup

### 1. Clone and Navigate
```bash
git clone <repository-url>
cd flask-copilot-starter
```

### 2. Environment Setup
```bash
# Install dependencies
pipenv install

# Install development dependencies
pipenv install --dev

# Activate virtual environment
pipenv shell
```

### 3. Environment Configuration
```bash
# Copy environment template
cp .env.example .env

# Edit .env with your configuration
# At minimum, set a unique SECRET_KEY
```

### 4. Database Setup
```bash
# Initialize database
pipenv run flask db init

# Create migration
pipenv run flask db migrate -m "Initial migration"

# Apply migration
pipenv run flask db upgrade
```

## ‚ö° Speed-First Development Workflow

### For Flask Applications

#### Running the Application ‚ö°
```bash
# IMMEDIATE START - NO DELAYS
pipenv run flask run
# OR
pipenv run python run.py
```

### For Flask Extensions

#### Testing Extensions ‚ö°
```bash
# FAST TESTING CYCLE
pipenv run pytest tests/test_extension.py | grep -E "(PASSED|FAILED|ERROR)"     # Unit tests
pipenv run python tests/test_app.py          # Integration test
tox                                           # Multi-version test
```

#### Extension Development ‚ö°
**NO-ANALYSIS RULES:**
- Extension class with `init_app()` ‚Üí STANDARD pattern, use immediately
- Flask extension naming ‚Üí Follow `Flask-ExtensionName` convention
- Configuration ‚Üí Use Flask config system, no custom patterns
- Documentation ‚Üí Include usage examples, API reference

### ‚ö° Immediate Testing Workflows
```bash
# FAST TEST EXECUTION - NO DELAYS ‚ö° GREP REQUIRED
pipenv run pytest | grep -E "(PASSED|FAILED|ERROR)"           # Status only
pipenv run pytest --cov=app | grep -E "TOTAL.*[0-9]+%"        # Coverage %
pipenv run pytest | grep -q "FAILED" && echo "‚ùå FIX NEEDED" || echo "‚úÖ GOOD"  # Quick check
pipenv run pytest tests/unit/test_models.py | grep -E "(PASSED|FAILED|ERROR)"   # Specific file

# ‚ö° SPEED-FIRST: Use grep to filter output for specific information
# Traditional commands (avoid - use grep versions above instead):
# pipenv run pytest                              # All tests (too verbose)
# pipenv run pytest --cov=app                   # With coverage (too verbose)
```

### ‚ö° Code Quality (Auto-Format)
```bash
# IMMEDIATE FORMATTING - NO ANALYSIS
pipenv run black .        # Format code
pipenv run flake8         # Lint code  
pipenv run mypy app/      # Type checking (if using mypy)
```

## ‚ö° Database Management (NO DELAYS)

### Flask-Migrate Workflow ‚ö°
```bash
# IMMEDIATE EXECUTION - NO ANALYSIS PHASE
pipenv run flask db migrate -m "Description"   # Create migration
pipenv run flask db upgrade                    # Apply migration  
pipenv run flask db downgrade                  # Rollback migration
```

### Database Reset ‚ö° (Development Only)
```bash
# WARNING: Deletes all data - IMMEDIATE execution
rm app.db
pipenv run flask db upgrade
```

## ‚ö° Speed-First Decision Framework Integration

### IMMEDIATE Decision Rules (< 2 minutes)
- **Code style/formatting** ‚Üí Follow existing patterns, NO ANALYSIS
- **Standard operations** (CRUD, routing) ‚Üí Use established patterns, NO ANALYSIS  
- **Testing approach** ‚Üí Follow current test structure, NO ANALYSIS

### FAST Decision Rules (< 10 minutes)  
- **New features** ‚Üí Break into smallest components, start simple
- **Database changes** ‚Üí Use Flask-Migrate workflow, follow model patterns
- **API design** ‚Üí Follow existing API structure and conventions

### Decision Hierarchy ‚ö°
1. **SIMPLEST working solution** (80% default choice)
2. **ESTABLISHED pattern** from existing codebase (15% of cases)
3. **INDUSTRY standard** approach (4% of cases)
4. **CUSTOM solution** (1% only - when 1-3 insufficient)

### EMERGENCY Decision Protocol ‚ö°
**If stuck > 2 minutes on ANY decision:**
1. ‚è∞ **STOP** analysis immediately
2. üéØ **CHOOSE** simplest approach that could work  
3. üöÄ **IMPLEMENT** and iterate
4. üìñ **REFER** to `docs/copilot/DECISION_FRAMEWORK.md`

## Testing Guidelines

### Test Database
- Tests use separate database (`sqlite:///:memory:` by default)
- Never run tests against production database
- Each test runs in isolated transaction

### Writing Tests
- Follow naming convention: `test_[unit]_[scenario]_[expected_result]`
- Use descriptive docstrings
- Group related tests in classes
- Mock external dependencies

## Common Issues

### Pipenv Issues
```bash
# Clear cache
pipenv --clear

# Reinstall dependencies
pipenv install --dev
```

### Database Issues
```bash
# Reset migrations (development only)
rm -rf migrations/
pipenv run flask db init
pipenv run flask db migrate
pipenv run flask db upgrade
```

## Development Best Practices

### Code Organization

#### For Flask Applications
- Use application factory pattern
- Organize routes in blueprints
- Keep functions small and focused
- Use type hints consistently

#### For Flask Extensions
- Create extension class with `init_app()` method
- Support both application factory and direct app binding
- Provide clear configuration options
- Include comprehensive documentation and examples
- Follow Flask extension naming conventions (`Flask-ExtensionName`)

### Documentation
- Update docstrings when changing functions
- Update API documentation for new endpoints
- Add changelog entries for significant changes
- Keep documentation synchronized with code

### Git Workflow
```bash
# Create feature branch
git checkout -b feature/new-feature

# Make changes and commit
git add .
git commit -m "Add new feature with tests and documentation"

# Update documentation
# Update CHANGELOG.md
# Push and create pull request
```

## ‚ö° AI Collaboration Workflow (SPEED-OPTIMIZED)

### Time-Boxed Development Process ‚ö°
Enhanced 8-step workflow with **STRICT** analysis paralysis prevention:

#### Pre-Development (Steps 1-3) - MAX 15 MINUTES TOTAL
```bash
# 1. Git Status Check ‚ö° (MANDATORY - 30 seconds max)
git status

# 2. Analysis Phase ‚ö° (STRICTLY ENFORCED: MAX 10 minutes)
# - Request analysis from Copilot  
# - LIMIT to 2-3 approaches maximum
# - Focus on SIMPLEST viable solution first
# - SET TIMER: Auto-proceed after 10 minutes

# 3. Approval Phase ‚ö° (STRICTLY ENFORCED: MAX 5 minutes)
# - Get explicit approval for chosen approach
# - AUTO-PROCEED rule: Low-risk changes proceed after 5 minutes
# - EMERGENCY: Choose simplest option if decision takes > 5 minutes
```

#### Development (Steps 4-6) - IMMEDIATE EXECUTION
```bash
# 4. Implementation ‚ö° (NO DELAYS)
# - Follow approved plan with NO additional analysis
# - Include comprehensive error handling
# - Add detailed docstrings

# 5. Testing ‚ö° (NO DELAYS) - GREP REQUIRED
pipenv run pytest --cov=app | grep -E "TOTAL.*[0-9]+%"

# 6. Cleanup and Verification ‚ö° (NO DELAYS)
# - Remove temporary files
# - Reset test database  
# - Validate clean state
```

#### Documentation (Steps 7-8) - IMMEDIATE EXECUTION
```bash
# 7. Documentation Updates ‚ö° (NO ANALYSIS)
# - Update API docs, README, DEVELOPMENT, CHANGELOG
# - Save to Copilot knowledge base:
#   - docs/copilot/INTERACTIONS.md
#   - docs/copilot/PROMPTS.md
#   - docs/copilot/LESSONS.md
#   - docs/copilot/DECISION_FRAMEWORK.md

# 8. Git Commit ‚ö° (NO DELAYS)
git add .
git commit -m "feat: description of changes"
```

## Environment Variables

### Required Variables
- `SECRET_KEY` - Flask secret key for sessions
- `FLASK_ENV` - development/production
- `DATABASE_URL` - Database connection string (optional)

### Optional Variables
- `DEBUG` - Enable debug mode (development only)
- `LOG_LEVEL` - Logging level (DEBUG, INFO, WARNING, ERROR)

## Directory Structure

### Flask Application Structure
```
flask-copilot-starter/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py         # Application factory
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # Configuration classes
‚îÇ   ‚îú‚îÄ‚îÄ models/             # Database models
‚îÇ   ‚îú‚îÄ‚îÄ routes/             # Blueprint routes
‚îÇ   ‚îú‚îÄ‚îÄ templates/          # Jinja2 templates
‚îÇ   ‚îî‚îÄ‚îÄ static/             # Static files
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py         # Test configuration
‚îÇ   ‚îú‚îÄ‚îÄ unit/               # Unit tests
‚îÇ   ‚îú‚îÄ‚îÄ integration/        # Integration tests
‚îÇ   ‚îî‚îÄ‚îÄ functional/         # Functional tests
‚îú‚îÄ‚îÄ docs/                   # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ copilot/           # AI collaboration knowledge base
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DECISION_FRAMEWORK.md # Quick decision guidelines
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ INTERACTIONS.md       # Successful patterns
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PROMPTS.md           # Effective templates
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LESSONS.md           # Best practices
‚îÇ   ‚îú‚îÄ‚îÄ README.md          # Project overview
‚îÇ   ‚îú‚îÄ‚îÄ DEVELOPMENT.md     # This file
‚îÇ   ‚îú‚îÄ‚îÄ CHANGELOG.md       # Change history
‚îÇ   ‚îî‚îÄ‚îÄ COPILOT.md         # AI collaboration guide
‚îú‚îÄ‚îÄ migrations/             # Database migrations
‚îú‚îÄ‚îÄ Pipfile                 # Dependencies
‚îî‚îÄ‚îÄ run.py                  # Application entry point
```

### Flask Extension Structure
```
flask-extension-name/
‚îú‚îÄ‚îÄ flask_extension_name/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py         # Extension class and init_app()
‚îÇ   ‚îú‚îÄ‚îÄ core.py             # Core extension functionality
‚îÇ   ‚îú‚îÄ‚îÄ utils.py            # Utility functions
‚îÇ   ‚îî‚îÄ‚îÄ templates/          # Optional: Extension templates
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py         # Test configuration
‚îÇ   ‚îú‚îÄ‚îÄ test_extension.py   # Extension unit tests
‚îÇ   ‚îú‚îÄ‚îÄ test_integration.py # Integration tests
‚îÇ   ‚îî‚îÄ‚îÄ test_app.py         # Sample test application
‚îú‚îÄ‚îÄ docs/                   # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ copilot/           # AI collaboration knowledge base
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DECISION_FRAMEWORK.md # Quick decision guidelines  
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ INTERACTIONS.md       # Successful patterns
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PROMPTS.md           # Effective templates
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LESSONS.md           # Best practices
‚îÇ   ‚îî‚îÄ‚îÄ API.md             # Extension API documentation
‚îú‚îÄ‚îÄ examples/               # Usage examples
‚îú‚îÄ‚îÄ setup.py                # Package configuration
‚îú‚îÄ‚îÄ MANIFEST.in             # Package manifest
‚îú‚îÄ‚îÄ tox.ini                 # Multi-environment testing
‚îî‚îÄ‚îÄ README.md               # Extension documentation
```

---

*Last updated: June 11, 2025 - Enhanced with speed-first anti-paralysis measures*
*This guide evolves with the project. Update it regularly to reflect new patterns and workflows.*
